In machine learning, knowledge distillation or model distillation is the process of transferring knowledge from a large model to a smaller one. While large models (such as very deep neural networks or ensembles of many models) have more knowledge capacity than small models, this capacity might not be fully utilized.  It can be just as computationally expensive to evaluate a model even if it utilizes little of its knowledge capacity.  Knowledge distillation transfers knowledge from a large model to a smaller one without loss of validity.  As smaller models are less expensive to evaluate, they can be deployed on less powerful hardware (such as a mobile device).

There is also a less common technique called Reverse Knowledge Distillation, where knowledge is transferred from a smaller model to a larger one.

Model distillation is not to be confused with model compression, which describes methods to decrease the size of a large model itself, without training a new model. Model compression generally preserves the architecture and the nominal parameter count of the model, while decreasing the bits-per-parameter.

Knowledge distillation has been successfully used in several applications of machine learning such as object detection, acoustic models, and natural language processing.

Recently, it has also been introduced to graph neural networks applicable to non-grid data.

Methods

Knowledge transfer from a large model to a small one somehow needs to teach the latter without loss of validity. If both models are trained on the same data, the smaller model may have insufficient capacity to learn a concise knowledge representation compared to the large model.  However, some information about a concise knowledge representation is encoded in the pseudolikelihoods assigned to its output: when a model correctly predicts a class, it assigns a large value to the output variable corresponding to such class, and smaller values to the other output variables. The distribution of values among the outputs for a record provides information on how the large model represents knowledge.  Therefore, the goal of economical deployment of a valid model can be achieved by training only the large model on the data, exploiting its better ability to learn concise knowledge representations, and then distilling such knowledge into the smaller model, by training it to learn the soft output of the large model. Their deep networks were trained layer by layer through regression analysis. Superfluous hidden units were pruned using a separate validation set. Other neural network compression methods include Biased Weight Decay and Optimal Brain Damage.

An early example of neural network distillation was published by Jürgen Schmidhuber in 1991, in the field of recurrent neural networks (RNNs). The problem was sequence prediction for long sequences, i.e., deep learning. Their approach was to use two RNNs. One of them (the automatizer) predicted the sequence, and another (the chunker) predicted the errors of the automatizer. Simultaneously, the automatizer predicted the internal states of the chunker. After the automatizer manages to predict the chunker's internal states well, it would start fixing the errors, and soon the chunker is obsoleted, leaving just one RNN in the end.

The idea of using the output of one neural network to train another neural network was also studied as the teacher-student network configuration. In 1992, several papers studied the statistical mechanics of teacher-student  configurations with committee machines or parity machines.

Compressing the knowledge of multiple models into a single neural network was called model compression in 2006: compression was achieved by training a smaller model on large amounts of pseudo-data labelled by a higher-performing ensemble, optimizing to match the logit of the compressed model to the logit of the ensemble. The knowledge distillation preprint of Geoffrey Hinton et al. (2015)

References

External links

Distilling the knowledge in a neural network – Google AI

Category:Deep learning