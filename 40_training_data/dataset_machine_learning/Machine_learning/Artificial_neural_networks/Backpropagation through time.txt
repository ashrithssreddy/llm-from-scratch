Backpropagation through time (BPTT) is a gradient-based technique for training certain types of recurrent neural networks, such as Elman networks. The algorithm was independently derived by numerous researchers.

Algorithm

The training data for a recurrent neural network is an ordered sequence of k input-output pairs, \langle \mathbf{a}_0,\mathbf{y}_0 \rangle, \langle\mathbf{a}_1,\mathbf{y}_1 \rangle,\langle\mathbf{a}_2,\mathbf{y}_2\rangle,...,\langle\mathbf{a}_{k-1},\mathbf{y}_{k-1}\rangle. An initial value must be specified for the hidden state \mathbf{x}_0, typically chosen to be a zero vector.

BPTT begins by unfolding a recurrent neural network in time. The unfolded network contains k inputs and outputs, but every copy of the network shares the same parameters. Then, the backpropagation algorithm is used to find the gradient of the loss function with respect to all the network parameters.

Consider an example of a neural network that contains a recurrent layer f and a feedforward layer g. There are different ways to define the training cost, but the aggregated cost is always the average of the costs of each of the time steps. The cost of each time step can be computed separately. The figure above shows how the cost at time t + 3 can be computed, by unfolding the recurrent layer f for three time steps and adding the feedforward layer g. Each instance of f in the unfolded network shares the same parameters. Thus, the weight updates in each instance (f_1, f_2, f_3) are summed together.

Pseudocode

Below is pseudocode for a truncated version of BPTT, where the training data contains n input-output pairs, and the network is unfolded for k time steps:

Back_Propagation_Through_Time(a, y)   // a[t] is the input at time t. y[t] is the output

Unfold the network to contain k instances of f

do until stopping criterion is met:

x := the zero-magnitude vector // x is the current context

for t from 0 to n − k do      // t is time. n is the length of the training sequence

Set the network inputs to x, a[t], a[t+1], ..., a[t+k−1]

p := forward-propagate the inputs over the whole unfolded network

e := y[t+k] − p;           // error = target − prediction

Back-propagate the error, e, back across the whole unfolded network

Sum the weight changes in the k instances of f together.

Update all the weights in f and g.

x := f(x, a[t]);           // compute the context for the next time-step

Advantages

BPTT tends to be significantly faster for training recurrent neural networks than general-purpose optimization techniques such as evolutionary optimization.

Disadvantages

BPTT has difficulty with local optima. With recurrent neural networks, local optima are a much more significant problem than with feed-forward neural networks. The recurrent feedback in such networks tends to create chaotic responses in the error surface which cause local optima to occur frequently, and in poor locations on the error surface.

See also

Backpropagation through structure

References

Category:Artificial neural networks