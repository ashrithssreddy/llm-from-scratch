In machine learning, the vanishing gradient problem is the problem of greatly diverging gradient magnitudes between earlier and later layers encountered when training neural networks with backpropagation. In such methods, neural network weights are updated proportional to their partial derivative of the loss function. As the number of forward propagation steps in a network increases, for instance due to greater network depth, the gradients of earlier weights are calculated with increasingly many multiplications. These multiplications shrink the gradient magnitude. Consequently, the gradients of earlier weights will be exponentially smaller than the gradients of later weights. This difference in gradient magnitude might introduce instability in the training process, slow it, or halt it entirely. which not only affects many-layered feedforward networks, but also recurrent networks. The latter are trained by unfolding them into very deep feedforward networks, where a new layer is created for each time-step of an input sequence processed by the network (the combination of unfolding and backpropagation is termed backpropagation through time).

Prototypical models

This section is based on the paper On the difficulty of training Recurrent Neural Networks by Pascanu, Mikolov, and Bengio. consider this one-neuron recurrent network with sigmoid activation:

x_{t+1} = (1-\varepsilon) x_t + \varepsilon \sigma(wx_t + b) + \varepsilon w' u_t

At the small \varepsilon limit, the dynamics of the network becomes

\frac{dx}{dt} = -x(t) + \sigma(wx(t)+b) + w' u(t)

Consider first the autonomous case, with  Set  and vary b  in [-3, -2] . As b  decreases, the system has 1 stable point, then has 2 stable points and 1 unstable point, and finally has 1 stable point again. Explicitly, the stable points are {{nowrap|(x, b) = \left(x, \ln\left(\frac{x}{1-x}\right)-5x \right).}}

Now consider \frac{\Delta x(T)}{\Delta x(0)}  and \frac{\Delta x(T)}{\Delta b} , where T  is large enough that the system has settled into one of the stable points.

If (x(0), b)  puts the system very close to an unstable point, then a tiny variation in x(0)  or b  would make x(T)  move from one stable point to the other. This makes \frac{\Delta x(T)}{\Delta x(0)}  and \frac{\Delta x(T)}{\Delta b}  both very large, a case of the exploding gradient.

If (x(0), b)  puts the system far from an unstable point, then a small variation in x(0)  would have no effect on x(T) , making \frac{\Delta x(T)}{\Delta x(0)}= 0 , a case of the vanishing gradient.

Note that in this case, \frac{\Delta x(T)}{\Delta b}\approx \frac{\partial x(T)}{\partial b} = \left(\frac{1}{x(T)(1-x(T))}-5\right)^{-1}  neither decays to zero nor blows up to infinity. Indeed, it's the only well-behaved gradient, which explains why early researches focused on learning or designing recurrent networks systems that could perform long-ranged computations (such as outputting the first input it sees at the very end of an episode) by shaping its stable attractors.

For the general case, the intuition still holds (

For the exploding gradient problem, (Pascanu et al, 2012)

Multi-level hierarchy

In multi-level hierarchy of networks (Schmidhuber, 1992), pre-trained one level at a time through unsupervised learning, fine-tuned through backpropagation. Here each level learns a compressed representation of the observations that is fed to the next level.

Deep belief network

Similar ideas have been used in feed-forward neural networks for unsupervised pre-training to structure a neural network, making it first learn generally useful feature detectors. Then the network is trained further by supervised backpropagation to classify labeled data. The deep belief network model by Hinton et al. (2006) involves learning the distribution of a high-level representation using successive layers of binary or real-valued latent variables. It uses a restricted Boltzmann machine to model each new layer of higher level features. Each new layer guarantees an increase on the lower-bound of the log likelihood of the data, thus improving the model, if trained properly. Once sufficiently many layers have been learned the deep architecture may be used as a generative model by reproducing the data when sampling down the model (an "ancestral pass") from the top level feature activations. Hinton reports that his models are effective feature extractors over high-dimensional, structured data.

Faster hardware

Hardware advances have meant that from 1991 to 2015, computer power (especially as delivered by GPUs) has increased around a million-fold, making standard backpropagation feasible for networks several layers deeper than when the vanishing gradient problem was recognized. Schmidhuber notes that this "is basically what is winning many of the image recognition competitions now", but that it "does not really overcome the problem in a fundamental way" since the original models tackling the vanishing gradient problem by Hinton and others were trained in a Xeon processor, not GPUs.

Concretely, let the neural network (without residual connections) be f_n \circ f_{n-1} \circ\cdots\circ f_1, then with residual connections, the gradient of output with respect to the activations at layer l is I + \nabla f_{l+1} + \nabla f_{l+2}\nabla f_{l+1} + \cdots. The gradient thus does not vanish in arbitrarily deep networks.

Feedforward networks with residual connections can be regarded as an ensemble of relatively shallow nets. In this perspective, they resolve the vanishing gradient problem by being equivalent to ensembles of many shallow networks, for which there is no vanishing gradient problem.

Other activation functions

Rectifiers such as ReLU suffer less from the vanishing gradient problem, because they only saturate in one direction.

Weight initialization

Weight initialization is another approach that has been proposed to reduce the vanishing gradient problem in deep networks.

Kumar suggested that the distribution of initial weights should vary according to activation function used and proposed to initialize the weights in networks with the logistic activation function using a Gaussian distribution with a zero mean and a standard deviation of 3.6/\sqrt{N}, where N is the number of neurons in a layer.

Recently, Yilmaz and Poli performed a theoretical analysis on how gradients are affected by the mean of the initial weights in deep neural networks using the logistic activation function and found that gradients do not vanish if the mean of the initial weights is set according to the formula: \max(-1,-8/N). This simple strategy allows networks with 10 or 15 hidden layers to be trained very efficiently and effectively using the standard backpropagation.

Other

Behnke relied only on the sign of the gradient (Rprop) when training his Neural Abstraction Pyramid to solve problems like image reconstruction and face localization.

Neural networks can also be optimized by using a universal search algorithm on the space of neural network's weights, e.g., random guess or more systematically genetic algorithm. This approach is not based on gradient and avoids the vanishing gradient problem.

See also

Spectral radius

Notes

References

Category:Artificial neural networks