The reparameterization trick (aka "reparameterization gradient estimator") is a technique used in statistical machine learning, particularly in variational inference, variational autoencoders, and stochastic optimization. It allows for the efficient computation of gradients through random variables, enabling the optimization of parametric probability models using stochastic gradient descent, and the variance reduction of estimators.

It was developed in the 1980s in operations research, under the name of "pathwise gradients", or "stochastic gradients". Its use in variational inference was proposed in 2013.

Mathematics

Let z be a random variable with distribution q_\phi(z), where \phi is a vector containing the parameters of the distribution.

REINFORCE estimator

Consider an objective function of the form:L(\phi) = \mathbb{E}_{z \sim q_\phi(z)}[f(z)]Without the reparameterization trick, estimating the gradient \nabla_\phi L(\phi)   can be challenging, because the parameter appears in the random variable itself. In more detail, we have to statistically estimate:\nabla_\phi L(\phi) = \nabla_\phi \int dz \; q_\phi(z) f(z)  The REINFORCE estimator, widely used in reinforcement learning and especially policy gradient, uses the following equality:\nabla_\phi L(\phi) =  \int dz \; q_\phi(z) \nabla_\phi(\ln q_\phi(z)) f(z) =

\mathbb{E}_{z \sim q_\phi(z)}[\nabla_\phi(\ln q_\phi(z)) f(z)]This allows the gradient to be estimated:\nabla_\phi L(\phi) \approx \frac 1N \sum_{i=1}^N \nabla_\phi(\ln q_\phi(z_i)) f(z_i)   The REINFORCE estimator has high variance, and many methods were developed to reduce its variance.

Reparameterization estimator

The reparameterization trick expresses z as:z = g_\phi(\epsilon), \quad \epsilon \sim p(\epsilon)Here, g_\phi is a deterministic function parameterized by \phi, and \epsilon is a noise variable drawn from a fixed distribution p(\epsilon). This gives:L(\phi) = \mathbb{E}_{\epsilon \sim p(\epsilon)}[f(g_\phi(\epsilon))] Now, the gradient can be estimated as:\nabla_\phi L(\phi) = \mathbb{E}_{\epsilon \sim p(\epsilon)}[\nabla_\phi f(g_\phi(\epsilon))]

\approx \frac 1N \sum_{i=1}^N \nabla_\phi f(g_\phi(\epsilon_i))

Examples

For some common distributions, the reparameterization trick takes specific forms:

Normal distribution: For z \sim \mathcal{N}(\mu, \sigma^2), we can use:z = \mu + \sigma \epsilon, \quad \epsilon \sim \mathcal{N}(0, 1)

Exponential distribution: For z \sim \text{Exp}(\lambda), we can use:z = -\frac{1}{\lambda} \log(\epsilon), \quad \epsilon \sim \text{Uniform}(0, 1)Discrete distribution can be reparameterized by the Gumbel distribution (Gumbel-softmax trick or "concrete distribution").

In general, any distribution that is differentiable with respect to its parameters can be reparameterized by inverting the multivariable CDF function, then apply the implicit method. See

See also

Variational autoencoder

Stochastic gradient descent

Variational inference

References

Further reading

{{cite web |last=Mohamed |first=Shakir |date=October 29, 2015 |title=Machine Learning Trick of the Day (4): Reparameterisation Tricks |url=https://blog.shakirm.com/2015/10/machine-learning-trick-of-the-day-4-reparameterisation-tricks/ |access-date=September 23, 2024 |website=The Spectator |ref=}}

Category:Machine learning

Category:Stochastic optimization