The Hoshen–Kopelman algorithm is a simple and efficient algorithm for labeling clusters on a grid, where the grid is a regular network of cells, with the cells being either occupied or unoccupied. This algorithm is based on a well-known union-finding algorithm. The algorithm was originally described by Joseph Hoshen and Raoul Kopelman in their 1976 paper "Percolation and Cluster Distribution. I. Cluster Multiple Labeling Technique and Critical Concentration Algorithm".

Percolation theory

Percolation theory is the study of the behavior and statistics of clusters on lattices. Suppose we have a large square lattice where each cell can be occupied with the probability p and can be empty with the probability 1&nbsp;–&nbsp;p. Each group of neighboring occupied cells forms a cluster. Neighbors are defined as cells having a common side but not those sharing only a corner i.e. we consider the 4-connected neighborhood that is top, bottom, left and right. Each occupied cell is independent of the status of its neighborhood. The number of clusters, the size of each cluster and their distribution are important topics in percolation theory.

Hoshen–Kopelman algorithm for cluster finding

In this algorithm, we scan through a grid looking for occupied cells and labeling them with cluster labels. The scanning process is called a raster scan. The algorithm begins with scanning the grid cell by cell and checking whether the cell is occupied or not. If the cell is occupied, then it must be labeled with a cluster label. This cluster label is assigned based on the neighbors of that cell. (For this we are going to use Union-Find Algorithm which is explained in the next section.) If the cell doesn’t have any occupied neighbors, then a new label is assigned to the cell.  On completion, the cluster labels may be found in labels.  Not shown is the second raster scan of the grid needed to produce the example output.  In that scan, the value at label[x,y] is replaced by find(label[x,y]).

Raster Scan and Labeling on the Grid

largest_label = 0;

label = zeros[n_columns, n_rows]

labels = [0:n_columns*n_rows] /* Array containing integers from 0 to the size of the image. */

for x in 0 to n_columns {

for y in 0 to n_rows {

if occupied[x, y] then

left = label[x-1, y];

above = label[x, y-1];

if (left == 0) and (above == 0) then /* Neither a label above nor to the left. */

largest_label = largest_label + 1; /* Make a new, as-yet-unused cluster label. */

label[x, y] = largest_label;

else if (left != 0) and (above == 0) then /* One neighbor, to the left. */

label[x, y] = find(left);

else if (left == 0) and (above != 0) then /* One neighbor, above. */

label[x, y] = find(above);

else /* Neighbors BOTH to the left and above. */

union(left,above); /* Link the left and above clusters. */

label[x, y] = find(left);

}

}

Union

void union(int x, int y) {

labels[find(x)] = find(y);

}

Find

int find(int x) {

int y = x;

while (labels[y] != y)

y = labels[y];

while (labels[x] != x)  {

int z = labels[x];

labels[x] = y;

x = z;

}

return y;

}

Example

Consider the following example. The dark cells in the grid in Figure (c) represent that they are occupied and the white ones are empty. So by running H–K algorithm on this input we would get the output as shown in Figure (d) with all the clusters labeled.

The algorithm processes the input grid, cell by cell, as follows: Let's say that grid is a two-dimensional array.

Starting from cell grid i.e. the first cell. The cell is occupied and it doesn't have cells to the left or above so we will label this cell with a new label say 1.

grid and grid both are unoccupied so they are not labeled.

grid is occupied so check cell to the left which is unoccupied so we increment the current label value and assign the label to the cell as 2.

grid, grid and grid are unoccupied so they are not labeled.

grid is occupied so check cell to the left and above, both the cells are unoccupied so assign a new label 3.

grid is occupied so check cell to the left and above, only the cell to the left is occupied so assign the label of a cell on the left to this cell 3.

grid is occupied so check cell to the left and above, both the cells are occupied, so merge the two clusters and assign the cluster label of the cell above to the cell on the left and to this cell i.e. 2. (Merging using union algorithm will  label all the cells with label 3 to 2)

grid is occupied so check cell to the left and above, only the cell to the left is occupied so assign the label of a cell on the left to this cell 2.

grid , grid and grid are unoccupied so they are not labeled.

grid is occupied so check cell to the left and above, only cell above is occupied so assign the label of the cell above to this cell 2.

grid , grid and grid are unoccupied so they are not labeled.

grid is occupied so check cell above which is unoccupied so we increment the current label value and assign the label to the cell as 4.

grid is occupied so check cell to the left and above, only the cell to the left is occupied so assign the label of the cell on the left to this cell 4.

grid is unoccupied so it is not labeled.

grid is occupied so check cell to the left and above, both the cells are unoccupied so assign a new label 5.

grid is occupied so check cell to the left and above, only the cell to the left is occupied so assign the label of the cell on the left to this cell 5.

grid , grid and grid are unoccupied so they are not labeled.

grid is occupied so check cell to the left and above, both the cells are unoccupied so assign a new label 6.

grid is occupied so check cell to the left and above, both, cell to the left and above are occupied so merge the two clusters and assign the cluster label of the cell above to the cell on the left and to this cell i.e. 5. (Merging using union algorithm will  label all the cells with label 6 to 5).

grid is unoccupied so it is not labeled.

grid is occupied so check cell to the left and above, both the cells are unoccupied so assign a new label 7.

grid , grid , grid and grid are unoccupied so they are not labeled.

grid is occupied so check cell to the left and above, both the cells are unoccupied so assign a new label 8.

grid is occupied so check cell to the left and above, both, cell to the left and above are occupied so merge the two clusters and assign the cluster label of the cell above to the cell on the left and to this cell i.e. 7. (Merging using union algorithm will  label all the cells with label 8 to 7).

Applications

Determination of Nodal Domain Area and Nodal Line Lengths

Nodal Connectivity Information

Modeling of electrical conduction

See also

K-means clustering algorithm

Fuzzy clustering algorithm

Gaussian (Expectation Maximization) clustering algorithm

Clustering Methods

C-means Clustering Algorithm

Connected-component labeling

References

Category:Cluster analysis algorithms